**https原理**

对称加密+非对称加密+CA认证



**为什么需要https？**

http协议采用的是明文进行传输，不安全，不会对数据做任何的加密，很容易被黑客截取数据。



**对称加密**

算法：f<sub>1</sub>(k, data) = X，f<sub>2</sub>(k, X) = data，这个k是服务端指定的，k是唯一的。

客户端在传输数据的时候，使用f1进行加密数据，服务器采用f2进行解密数据。单纯采用对称加密也是不安全的，因为黑客也可以拿到这个k。



**非对称加密**

算法：采用公钥对数据进行加密，可以采用私钥对数据进行解密；采用私钥加密，可以采用公钥解密。服务端有公钥和私钥，私钥在服务端，公钥给客户端。

f(pk, data) = Y，f(sk, Y) = data

采用这种方式吗，存在一个问题，如果把服务端的数据发送给客户端呢？

在服务端不能使用公钥加载数据，因为客户端拿不到私钥，无法解密数据。如果使用私钥进行加密数据，那也不安全，因为黑客也可以拿到公钥。



**对称加密+非对称加密**

先采用非对称加密，使得客户端和服务端先商量出一个k，然后再采用对称加密，使用这个k来进行数据传输，这样就能保证每个客户端有一个不同的k。

![](https://s3.bmp.ovh/imgs/2021/09/d9ef0b689d3de300.png)

这种方式也不是绝对安全，存在一个**中间人问题**【黑客在客户端和服务端中间充当一个中间人的角色，既冒充客户端也冒充服务端】。



**如何解决中间人问题？**

引入CA，解决我们拿到的公钥不知道是好是坏，也就是我们拿到的公钥不知道是服务端的还是黑客的。CA就可以帮我们验证我们拿到的公钥是否安全。

服务端不会直接把pk返回给客户端，而是先把pk进行加密，采用csk对pk进行加密，得到一个license证书。客户端在请求服务端的时候，拿到的是一个license。但是客户端最终是要得到pk，也就是需要通过cpk解析license得出pk，我们的操作系统中存储了大量的CA公钥cpk。这样就不需要去拿cpk保证了安全性。

![](https://s3.bmp.ovh/imgs/2021/09/05ef05042a1c28ca.png)



![](https://s3.bmp.ovh/imgs/2021/09/5ad39b70763d7a53.png)