1. vue里面用到了观察者模式
2. 默认组件渲染的时候，会创建一个watcher
3. 并且会渲染视图，当渲染视图的时候，会取data中的数据，会走每个属性的get方法，就让这个属性的dep记住watcher，同时让watcher也记住dep
4. dep和watcher是多对多的关系，因为一个属性可能对应多个视图，一个视图也可能对应多个数据
5. 如果数据发生变化，会通知对应属性的dep，依次通知存放的watcher去更新。





1. dep是用来收集渲染逻辑的（收集watcher的）。

2. 每个组件都有一个watcher，称之为渲染watcher，多个组件就会有多个watcher。

3. 只有在视图中使用到的数据发生变化才需要从新更新视图。

4. 只有在渲染的时候，才会进行依赖收集，因为渲染完毕后，就会将标识清空了（Dep.target = null）。
5. 页面初次渲染的时候，会将 Watcher 放到 Dep.target 上。渲染完毕将 Dep.target = null；
6. 调用render方法，就会立即取值，走到 get方法，让dep和watcher关联起来。

7. 触发set，会通知当前属性收集的watcher依次执行。
8. 组件挂载的时候就会创建 渲染Watcher。





vue中数组依赖收集

1. 数组本身也有一个dep属性，存放在数组的 \__ob__ 属性上
2. 数组和对象取值的时候都会触发 get 方法，进行dep和watcher的关联



## 面试答

1. 默认vue在初始化的时候，会对对象的每一个属性进行劫持，增加dep属性，当取值的时候，会触发get方法，进行依赖收集，让dep和watcher进行关联
2. 默认还会对属性值是对象或者是数组的属性进行依赖收集，其中对象和数组本身也会进行依赖收集
3. 如果属性发生了变化，触发set方法，执行dep中收集到的watcher更新视图
4. 如果是数组更新，触发数组本身的dep进行更新
5. 如果取值的时候是数组还要让数组中的对象类型进行递归依赖收集

